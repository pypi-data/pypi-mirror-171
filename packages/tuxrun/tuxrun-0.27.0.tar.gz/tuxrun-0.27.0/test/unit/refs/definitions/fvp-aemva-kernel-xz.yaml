device_type: "fvp"

job_name: "tuxrun@fvp-aemva"
priority: medium
visibility: public


timeouts:
  job:
    minutes: 15
  action:
    minutes: 10
  connection:
    minutes: 10

actions:
- deploy:
    to: fvp
    timeout:
      minutes: 5
    images:
      bl1:
        url: "/DATA/tf-bl1.bin"
      dtb:
        url: "https://storage.tuxboot.com/fvp-aemva/fvp-base-revc.dtb"
      kernel:
        url: "/DATA/zImage.xz"
        compression: xz
      rootfs:
        url: "https://example.com/rootfs.ext4.zst"
        compression: zstd
        format: ext4
      fip:
        url: "/DATA/fip.bin"
- boot:
    method: fvp
    docker:
      name: "fvp:aemva-11.18.16"
      local: true
      container_name: "tuxrun-ci"
    image: "/opt/model/FVP_AEMvA/models/Linux64_GCC-9.3/FVP_Base_RevC-2xAEMvA"
    version_string: "Fast Models [^\\n]+"
    timeout:
      minutes: 10
    console_string: "terminal_0: Listening for serial connection on port (?P<PORT>\\d+)"
    feedbacks:
    - "(?P<NAME>terminal_1): Listening for serial connection on port (?P<PORT>\\d+)"
    - "(?P<NAME>terminal_2): Listening for serial connection on port (?P<PORT>\\d+)"
    - "(?P<NAME>terminal_3): Listening for serial connection on port (?P<PORT>\\d+)"
    arguments:
    - "--plugin /opt/model/FVP_AEMvA/plugins/Linux64_GCC-9.3/ScalableVectorExtension.so"
    - "--data cluster0.cpu0={DTB}@0x8E000000"
    - "--data cluster0.cpu0={KERNEL}@0x80200000"
    - "-C pctl.startup=0.0.0.0"
    - "-C bp.secure_memory=0"
    - "-C cluster0.NUM_CORES=4"
    - "-C cluster1.NUM_CORES=4"
    - "-C cache_state_modelled=0"
    - "-C bp.smsc_91c111.enabled=true"
    - "-C bp.pl011_uart0.untimed_fifos=1"
    - "-C bp.pl011_uart0.unbuffered_output=1"
    - "-C bp.secureflashloader.fname='{BL1}'"
    - "-C bp.flashloader0.fname='{FIP}'"
    - "-C bp.ve_sysregs.mmbSiteDefault=0"
    - "-C bp.ve_sysregs.exit_on_shutdown=1"
    - "-C bp.virtioblockdevice.image_path='{ROOTFS}'"
    - "-C cluster0.has_large_system_ext=1"
    - "-C cluster1.has_large_system_ext=1"
    - "-C cluster0.has_16k_granule=1"
    - "-C cluster1.has_16k_granule=1"
    - "-C cluster0.has_branch_target_exception=1"
    - "-C cluster1.has_branch_target_exception=1"
    - "-C cluster0.has_rndr=1"
    - "-C cluster1.has_rndr=1"
    - "-C cluster0.has_arm_v8-1=1"
    - "-C cluster1.has_arm_v8-1=1"
    - "-C cluster0.has_arm_v8-2=1"
    - "-C cluster1.has_arm_v8-2=1"
    - "-C cluster0.has_arm_v8-3=1"
    - "-C cluster1.has_arm_v8-3=1"
    - "-C cluster0.has_arm_v8-4=1"
    - "-C cluster1.has_arm_v8-4=1"
    - "-C cluster0.has_arm_v8-5=1"
    - "-C cluster1.has_arm_v8-5=1"
    - "-C cluster0.has_arm_v8-6=1"
    - "-C cluster1.has_arm_v8-6=1"
    auto_login:
      login_prompt: '(.*)login:'
      username: root
    prompts:
    - 'root@(.*):[/~]#'

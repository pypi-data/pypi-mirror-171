{#
SPDX-License-Identifier: GPL-3.0-or-later OR CC-BY-SA-4.0

Proxy web UI package list page.

This file is part of Hydrilla&Haketilo.

Copyright (C) 2022 Wojtek Kosior

Dual licensed under
* GNU General Public License v3.0 or later and
* Creative Commons Attribution Share Alike 4.0 International.

You can choose to use either of these licenses or both.


I, Wojtek Kosior, thereby promise not to sue for violation of this
file's licenses. Although I request that you do not make use of this
code in a proprietary work, I am not going to enforce this in court.
#}
{% extends "base.html.jinja" %}

{% block title %} {{ _('web_ui.packages.title') }} {% endblock %}

{% block style %}
  {{ super() }}

  {% include 'include/item_list_style.css.jinja' %}

  ul.item-list > li > a {
      display: flex !important;
      flex-direction: column;
      justify-content: center;
      min-height: 2.2em;
  }
{% endblock %}

{% block main %}
  <h3>{{ _('web_ui.packages.heading') }}</h3>

  <ul class="item-list">
    {% for info in display_infos %}
      {% set entry_classes = [] %}

      {% if info.enabled == EnabledStatus.ENABLED %}
        {% do entry_classes.append('entry-line-blue') %}
      {% elif info.enabled == EnabledStatus.DISABLED %}
        {% do entry_classes.append('entry-line-red') %}
      {% elif info.active_version is not none %}
        {% if info.active_version.active == ActiveStatus.REQUIRED %}
          {% do entry_classes.append('entry-line-blue') %}
          {% do entry_classes.append('entry-line-dashed') %}
        {% elif info.active_version.active == ActiveStatus.AUTO %}
          {% do entry_classes.append('entry-line-green') %}
        {% endif %}
      {% endif %}

      <li class="{{ entry_classes|join(' ') }}">
        <a href="{{ url_for('.show_package', item_id=info.ref.id) }}">
          <div>
            {{ info.identifier }}
          </div>
          {%
            if info.active_version is not none and
                info.active_version.active == ActiveStatus.REQUIRED
          %}
            {% set ver_desc = info.active_version.info.version_string %}
            {% if not info.active_version.is_local %}
              {% set repo_name = info.active_version.info.repo %}
              {% set ver_desc = ver_desc + ' @ ' + repo_name %}
            {% endif %}
            <div class="small-print">
              {{ _('web_ui.packages.enabled_version_{}').format(ver_desc) }}
            </div>
          {% endif %}
        </a>
      </li>
    {% endfor %}
  </ul>
{% endblock %}

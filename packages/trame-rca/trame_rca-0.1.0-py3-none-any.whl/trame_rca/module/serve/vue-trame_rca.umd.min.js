(function(e,t){"object"===typeof exports&&"object"===typeof module?module.exports=t():"function"===typeof define&&define.amd?define([],t):"object"===typeof exports?exports["trame_rca"]=t():e["trame_rca"]=t()})("undefined"!==typeof self?self:this,(function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s="fae3")}({"04f8":function(e,t,n){var r=n("2d00"),o=n("d039");e.exports=!!Object.getOwnPropertySymbols&&!o((function(){var e=Symbol();return!String(e)||!(Object(e)instanceof Symbol)||!Symbol.sham&&r&&r<41}))},"06cf":function(e,t,n){var r=n("83ab"),o=n("c65b"),i=n("d1e7"),s=n("5c6c"),a=n("fc6a"),u=n("a04b"),c=n("1a2d"),f=n("0cfb"),d=Object.getOwnPropertyDescriptor;t.f=r?d:function(e,t){if(e=a(e),t=u(t),f)try{return d(e,t)}catch(n){}if(c(e,t))return s(!o(i.f,e,t),e[t])}},"07fa":function(e,t,n){var r=n("50c4");e.exports=function(e){return r(e.length)}},"0cfb":function(e,t,n){var r=n("83ab"),o=n("d039"),i=n("cc12");e.exports=!r&&!o((function(){return 7!=Object.defineProperty(i("div"),"a",{get:function(){return 7}}).a}))},"0d12":function(e,t,n){e.exports={container:"style_container_30yqq",inside:"style_inside_2PhAt"}},"0d51":function(e,t){var n=String;e.exports=function(e){try{return n(e)}catch(t){return"Object"}}},"13d2":function(e,t,n){var r=n("d039"),o=n("1626"),i=n("1a2d"),s=n("83ab"),a=n("5e77").CONFIGURABLE,u=n("8925"),c=n("69f3"),f=c.enforce,d=c.get,l=Object.defineProperty,p=s&&!r((function(){return 8!==l((function(){}),"length",{value:8}).length})),h=String(String).split("String"),v=e.exports=function(e,t,n){"Symbol("===String(t).slice(0,7)&&(t="["+String(t).replace(/^Symbol\(([^)]*)\)/,"$1")+"]"),n&&n.getter&&(t="get "+t),n&&n.setter&&(t="set "+t),(!i(e,"name")||a&&e.name!==t)&&(s?l(e,"name",{value:t,configurable:!0}):e.name=t),p&&n&&i(n,"arity")&&e.length!==n.arity&&l(e,"length",{value:n.arity});try{n&&i(n,"constructor")&&n.constructor?s&&l(e,"prototype",{writable:!1}):e.prototype&&(e.prototype=void 0)}catch(o){}var r=f(e);return i(r,"source")||(r.source=h.join("string"==typeof t?t:"")),e};Function.prototype.toString=v((function(){return o(this)&&d(this).source||u(this)}),"toString")},"14d9":function(e,t,n){"use strict";var r=n("23e7"),o=n("7b0b"),i=n("07fa"),s=n("3a34"),a=n("3511"),u=n("d039"),c=u((function(){return 4294967297!==[].push.call({length:4294967296},1)})),f=!function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(e){return e instanceof TypeError}}();r({target:"Array",proto:!0,arity:1,forced:c||f},{push:function(e){var t=o(this),n=i(t),r=arguments.length;a(n+r);for(var u=0;u<r;u++)t[n]=arguments[u],n++;return s(t,n),n}})},1626:function(e,t,n){var r=n("8ea1"),o=r.all;e.exports=r.IS_HTMLDDA?function(e){return"function"==typeof e||e===o}:function(e){return"function"==typeof e}},"1a2d":function(e,t,n){var r=n("e330"),o=n("7b0b"),i=r({}.hasOwnProperty);e.exports=Object.hasOwn||function(e,t){return i(o(e),t)}},"1d80":function(e,t,n){var r=n("7234"),o=TypeError;e.exports=function(e){if(r(e))throw o("Can't call method on "+e);return e}},"23cb":function(e,t,n){var r=n("5926"),o=Math.max,i=Math.min;e.exports=function(e,t){var n=r(e);return n<0?o(n+t,0):i(n,t)}},"23e7":function(e,t,n){var r=n("da84"),o=n("06cf").f,i=n("9112"),s=n("cb2d"),a=n("6374"),u=n("e893"),c=n("94ca");e.exports=function(e,t){var n,f,d,l,p,h,v=e.target,m=e.global,b=e.stat;if(f=m?r:b?r[v]||a(v,{}):(r[v]||{}).prototype,f)for(d in t){if(p=t[d],e.dontCallGetSet?(h=o(f,d),l=h&&h.value):l=f[d],n=c(m?d:v+(b?".":"#")+d,e.forced),!n&&void 0!==l){if(typeof p==typeof l)continue;u(p,l)}(e.sham||l&&l.sham)&&i(p,"sham",!0),s(f,d,p,e)}}},"241c":function(e,t,n){var r=n("ca84"),o=n("7839"),i=o.concat("length","prototype");t.f=Object.getOwnPropertyNames||function(e){return r(e,i)}},"2d00":function(e,t,n){var r,o,i=n("da84"),s=n("342f"),a=i.process,u=i.Deno,c=a&&a.versions||u&&u.version,f=c&&c.v8;f&&(r=f.split("."),o=r[0]>0&&r[0]<4?1:+(r[0]+r[1])),!o&&s&&(r=s.match(/Edge\/(\d+)/),(!r||r[1]>=74)&&(r=s.match(/Chrome\/(\d+)/),r&&(o=+r[1]))),e.exports=o},"342f":function(e,t,n){var r=n("d066");e.exports=r("navigator","userAgent")||""},3511:function(e,t){var n=TypeError,r=9007199254740991;e.exports=function(e){if(e>r)throw n("Maximum allowed index exceeded");return e}},"3a34":function(e,t,n){"use strict";var r=n("83ab"),o=n("e8b5"),i=TypeError,s=Object.getOwnPropertyDescriptor,a=r&&!function(){if(void 0!==this)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(e){return e instanceof TypeError}}();e.exports=a?function(e,t){if(o(e)&&!s(e,"length").writable)throw i("Cannot set read only .length");return e.length=t}:function(e,t){return e.length=t}},"3a9b":function(e,t,n){var r=n("e330");e.exports=r({}.isPrototypeOf)},"40d5":function(e,t,n){var r=n("d039");e.exports=!r((function(){var e=function(){}.bind();return"function"!=typeof e||e.hasOwnProperty("prototype")}))},"44ad":function(e,t,n){var r=n("e330"),o=n("d039"),i=n("c6b6"),s=Object,a=r("".split);e.exports=o((function(){return!s("z").propertyIsEnumerable(0)}))?function(e){return"String"==i(e)?a(e,""):s(e)}:s},"485a":function(e,t,n){var r=n("c65b"),o=n("1626"),i=n("861d"),s=TypeError;e.exports=function(e,t){var n,a;if("string"===t&&o(n=e.toString)&&!i(a=r(n,e)))return a;if(o(n=e.valueOf)&&!i(a=r(n,e)))return a;if("string"!==t&&o(n=e.toString)&&!i(a=r(n,e)))return a;throw s("Can't convert object to primitive value")}},"4d64":function(e,t,n){var r=n("fc6a"),o=n("23cb"),i=n("07fa"),s=function(e){return function(t,n,s){var a,u=r(t),c=i(u),f=o(s,c);if(e&&n!=n){while(c>f)if(a=u[f++],a!=a)return!0}else for(;c>f;f++)if((e||f in u)&&u[f]===n)return e||f||0;return!e&&-1}};e.exports={includes:s(!0),indexOf:s(!1)}},"50c4":function(e,t,n){var r=n("5926"),o=Math.min;e.exports=function(e){return e>0?o(r(e),9007199254740991):0}},5692:function(e,t,n){var r=n("c430"),o=n("c6cd");(e.exports=function(e,t){return o[e]||(o[e]=void 0!==t?t:{})})("versions",[]).push({version:"3.25.5",mode:r?"pure":"global",copyright:"Â© 2014-2022 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.25.5/LICENSE",source:"https://github.com/zloirock/core-js"})},"56ef":function(e,t,n){var r=n("d066"),o=n("e330"),i=n("241c"),s=n("7418"),a=n("825a"),u=o([].concat);e.exports=r("Reflect","ownKeys")||function(e){var t=i.f(a(e)),n=s.f;return n?u(t,n(e)):t}},5926:function(e,t,n){var r=n("b42e");e.exports=function(e){var t=+e;return t!==t||0===t?0:r(t)}},"59ed":function(e,t,n){var r=n("1626"),o=n("0d51"),i=TypeError;e.exports=function(e){if(r(e))return e;throw i(o(e)+" is not a function")}},"5c6c":function(e,t){e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},"5e77":function(e,t,n){var r=n("83ab"),o=n("1a2d"),i=Function.prototype,s=r&&Object.getOwnPropertyDescriptor,a=o(i,"name"),u=a&&"something"===function(){}.name,c=a&&(!r||r&&s(i,"name").configurable);e.exports={EXISTS:a,PROPER:u,CONFIGURABLE:c}},6374:function(e,t,n){var r=n("da84"),o=Object.defineProperty;e.exports=function(e,t){try{o(r,e,{value:t,configurable:!0,writable:!0})}catch(n){r[e]=t}return t}},"69f3":function(e,t,n){var r,o,i,s=n("cdce"),a=n("da84"),u=n("861d"),c=n("9112"),f=n("1a2d"),d=n("c6cd"),l=n("f772"),p=n("d012"),h="Object already initialized",v=a.TypeError,m=a.WeakMap,b=function(e){return i(e)?o(e):r(e,{})},y=function(e){return function(t){var n;if(!u(t)||(n=o(t)).type!==e)throw v("Incompatible receiver, "+e+" required");return n}};if(s||d.state){var g=d.state||(d.state=new m);g.get=g.get,g.has=g.has,g.set=g.set,r=function(e,t){if(g.has(e))throw v(h);return t.facade=e,g.set(e,t),t},o=function(e){return g.get(e)||{}},i=function(e){return g.has(e)}}else{var S=l("state");p[S]=!0,r=function(e,t){if(f(e,S))throw v(h);return t.facade=e,c(e,S,t),t},o=function(e){return f(e,S)?e[S]:{}},i=function(e){return f(e,S)}}e.exports={set:r,get:o,has:i,enforce:b,getterFor:y}},7234:function(e,t){e.exports=function(e){return null===e||void 0===e}},7418:function(e,t){t.f=Object.getOwnPropertySymbols},7839:function(e,t){e.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},"7b0b":function(e,t,n){var r=n("1d80"),o=Object;e.exports=function(e){return o(r(e))}},"7d7e":function(e,t,n){var r=n("40d5"),o=Function.prototype,i=o.call,s=r&&o.bind.bind(i,i);e.exports=function(e){return r?s(e):function(){return i.apply(e,arguments)}}},"825a":function(e,t,n){var r=n("861d"),o=String,i=TypeError;e.exports=function(e){if(r(e))return e;throw i(o(e)+" is not an object")}},"83ab":function(e,t,n){var r=n("d039");e.exports=!r((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]}))},"861d":function(e,t,n){var r=n("1626"),o=n("8ea1"),i=o.all;e.exports=o.IS_HTMLDDA?function(e){return"object"==typeof e?null!==e:r(e)||e===i}:function(e){return"object"==typeof e?null!==e:r(e)}},8925:function(e,t,n){var r=n("e330"),o=n("1626"),i=n("c6cd"),s=r(Function.toString);o(i.inspectSource)||(i.inspectSource=function(e){return s(e)}),e.exports=i.inspectSource},"8ea1":function(e,t){var n="object"==typeof document&&document.all,r="undefined"==typeof n&&void 0!==n;e.exports={all:n,IS_HTMLDDA:r}},"90e3":function(e,t,n){var r=n("e330"),o=0,i=Math.random(),s=r(1..toString);e.exports=function(e){return"Symbol("+(void 0===e?"":e)+")_"+s(++o+i,36)}},9112:function(e,t,n){var r=n("83ab"),o=n("9bf2"),i=n("5c6c");e.exports=r?function(e,t,n){return o.f(e,t,i(1,n))}:function(e,t,n){return e[t]=n,e}},"94ca":function(e,t,n){var r=n("d039"),o=n("1626"),i=/#|\.prototype\./,s=function(e,t){var n=u[a(e)];return n==f||n!=c&&(o(t)?r(t):!!t)},a=s.normalize=function(e){return String(e).replace(i,".").toLowerCase()},u=s.data={},c=s.NATIVE="N",f=s.POLYFILL="P";e.exports=s},"9bf2":function(e,t,n){var r=n("83ab"),o=n("0cfb"),i=n("aed9"),s=n("825a"),a=n("a04b"),u=TypeError,c=Object.defineProperty,f=Object.getOwnPropertyDescriptor,d="enumerable",l="configurable",p="writable";t.f=r?i?function(e,t,n){if(s(e),t=a(t),s(n),"function"===typeof e&&"prototype"===t&&"value"in n&&p in n&&!n[p]){var r=f(e,t);r&&r[p]&&(e[t]=n.value,n={configurable:l in n?n[l]:r[l],enumerable:d in n?n[d]:r[d],writable:!1})}return c(e,t,n)}:c:function(e,t,n){if(s(e),t=a(t),s(n),o)try{return c(e,t,n)}catch(r){}if("get"in n||"set"in n)throw u("Accessors not supported");return"value"in n&&(e[t]=n.value),e}},a04b:function(e,t,n){var r=n("c04e"),o=n("d9b5");e.exports=function(e){var t=r(e,"string");return o(t)?t:t+""}},aed9:function(e,t,n){var r=n("83ab"),o=n("d039");e.exports=r&&o((function(){return 42!=Object.defineProperty((function(){}),"prototype",{value:42,writable:!1}).prototype}))},b42e:function(e,t){var n=Math.ceil,r=Math.floor;e.exports=Math.trunc||function(e){var t=+e;return(t>0?r:n)(t)}},b622:function(e,t,n){var r=n("da84"),o=n("5692"),i=n("1a2d"),s=n("90e3"),a=n("04f8"),u=n("fdbf"),c=o("wks"),f=r.Symbol,d=f&&f["for"],l=u?f:f&&f.withoutSetter||s;e.exports=function(e){if(!i(c,e)||!a&&"string"!=typeof c[e]){var t="Symbol."+e;a&&i(f,e)?c[e]=f[e]:c[e]=u&&d?d(t):l(t)}return c[e]}},c04e:function(e,t,n){var r=n("c65b"),o=n("861d"),i=n("d9b5"),s=n("dc4a"),a=n("485a"),u=n("b622"),c=TypeError,f=u("toPrimitive");e.exports=function(e,t){if(!o(e)||i(e))return e;var n,u=s(e,f);if(u){if(void 0===t&&(t="default"),n=r(u,e,t),!o(n)||i(n))return n;throw c("Can't convert object to primitive value")}return void 0===t&&(t="number"),a(e,t)}},c430:function(e,t){e.exports=!1},c65b:function(e,t,n){var r=n("40d5"),o=Function.prototype.call;e.exports=r?o.bind(o):function(){return o.apply(o,arguments)}},c6b6:function(e,t,n){var r=n("7d7e"),o=r({}.toString),i=r("".slice);e.exports=function(e){return i(o(e),8,-1)}},c6cd:function(e,t,n){var r=n("da84"),o=n("6374"),i="__core-js_shared__",s=r[i]||o(i,{});e.exports=s},c8ba:function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(r){"object"===typeof window&&(n=window)}e.exports=n},ca84:function(e,t,n){var r=n("e330"),o=n("1a2d"),i=n("fc6a"),s=n("4d64").indexOf,a=n("d012"),u=r([].push);e.exports=function(e,t){var n,r=i(e),c=0,f=[];for(n in r)!o(a,n)&&o(r,n)&&u(f,n);while(t.length>c)o(r,n=t[c++])&&(~s(f,n)||u(f,n));return f}},cb2d:function(e,t,n){var r=n("1626"),o=n("9bf2"),i=n("13d2"),s=n("6374");e.exports=function(e,t,n,a){a||(a={});var u=a.enumerable,c=void 0!==a.name?a.name:t;if(r(n)&&i(n,c,a),a.global)u?e[t]=n:s(t,n);else{try{a.unsafe?e[t]&&(u=!0):delete e[t]}catch(f){}u?e[t]=n:o.f(e,t,{value:n,enumerable:!1,configurable:!a.nonConfigurable,writable:!a.nonWritable})}return e}},cc12:function(e,t,n){var r=n("da84"),o=n("861d"),i=r.document,s=o(i)&&o(i.createElement);e.exports=function(e){return s?i.createElement(e):{}}},cdce:function(e,t,n){var r=n("da84"),o=n("1626"),i=r.WeakMap;e.exports=o(i)&&/native code/.test(String(i))},d012:function(e,t){e.exports={}},d039:function(e,t){e.exports=function(e){try{return!!e()}catch(t){return!0}}},d066:function(e,t,n){var r=n("da84"),o=n("1626"),i=function(e){return o(e)?e:void 0};e.exports=function(e,t){return arguments.length<2?i(r[e]):r[e]&&r[e][t]}},d1e7:function(e,t,n){"use strict";var r={}.propertyIsEnumerable,o=Object.getOwnPropertyDescriptor,i=o&&!r.call({1:2},1);t.f=i?function(e){var t=o(this,e);return!!t&&t.enumerable}:r},d9b5:function(e,t,n){var r=n("d066"),o=n("1626"),i=n("3a9b"),s=n("fdbf"),a=Object;e.exports=s?function(e){return"symbol"==typeof e}:function(e){var t=r("Symbol");return o(t)&&i(t.prototype,a(e))}},da84:function(e,t,n){(function(t){var n=function(e){return e&&e.Math==Math&&e};e.exports=n("object"==typeof globalThis&&globalThis)||n("object"==typeof window&&window)||n("object"==typeof self&&self)||n("object"==typeof t&&t)||function(){return this}()||Function("return this")()}).call(this,n("c8ba"))},dc4a:function(e,t,n){var r=n("59ed"),o=n("7234");e.exports=function(e,t){var n=e[t];return o(n)?void 0:r(n)}},e330:function(e,t,n){var r=n("c6b6"),o=n("7d7e");e.exports=function(e){if("Function"===r(e))return o(e)}},e893:function(e,t,n){var r=n("1a2d"),o=n("56ef"),i=n("06cf"),s=n("9bf2");e.exports=function(e,t,n){for(var a=o(t),u=s.f,c=i.f,f=0;f<a.length;f++){var d=a[f];r(e,d)||n&&r(n,d)||u(e,d,c(t,d))}}},e8b5:function(e,t,n){var r=n("c6b6");e.exports=Array.isArray||function(e){return"Array"==r(e)}},efcf:function(e,t,n){"use strict";var r=n("0d12"),o=n.n(r);n.d(t,"default",(function(){return o.a}))},f772:function(e,t,n){var r=n("5692"),o=n("90e3"),i=r("keys");e.exports=function(e){return i[e]||(i[e]=o(e))}},fae3:function(e,t,n){"use strict";if(n.r(t),n.d(t,"install",(function(){return D})),"undefined"!==typeof window){var r=window.document.currentScript,o=r&&r.src.match(/(.+\/)[^/]+\.js(\?.*)?$/);o&&(n.p=o[1])}var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{class:e.$style.container,on:{mousedown:e.onMouseDown}},[n("div",{class:e.$style.inside},[n("display-area",{attrs:{name:e.name,origin:e.origin}}),e._t("default")],2)])},s=[];const a=Promise.resolve(!0);var u={name:"RemoteControlledArea",props:{name:{type:String,default:"default"},origin:{type:String,default:"anonymous"}},methods:{pushSize(e){this.trame&&(this.readySizeUpdate?(this.readySizeUpdate=!1,this.pendingSizeUpdatePromise=e?this.trame.client.getConnection().getSession().call("trame.rca.size",[this.name,this.origin,{...this.currentSizeUpdateEvent,...e}]):this.trame.client.getConnection().getSession().call("trame.rca.size",[this.name,this.origin,this.currentSizeUpdateEvent]),this.pendingSizeUpdatePromise.finally(this.finallySizeUpdate)):this.pendingSizeUpdateCount++)},onMouseDown(e){this.dragging=!0,e.preventDefault(),this.sendEvent(this.toEvent("mouse-down",e)),document.addEventListener("mousemove",this.onMouseMove),document.addEventListener("mouseup",this.onMouseUp)},toEvent(e,t){const{altKey:n,button:r,ctrlKey:o,shiftKey:i,x:s,y:a}=t,u=[s-this.currentOffset[0],a-this.currentOffset[1]];return{t:e,p:u,b:r,alt:n,ctrl:o,shift:i}},sendEvent(e){this.trame&&(this.readyMouseUpdate?(this.readyMouseUpdate=!1,this.lastEvent=e,this.pendingMouseUpdatePromise=this.trame.client.getConnection().getSession().call("trame.rca.event",[this.name,this.origin,this.lastEvent]),this.pendingSizeUpdatePromise.finally(this.finallyEventUpdate)):this.lastEvent.type!==e.type&&(this.pendingEventUpdateCount=0,this.trame.client.getConnection().getSession().call("trame.rca.event",[this.name,this.origin,this.lastEvent]),this.trame.client.getConnection().getSession().call("trame.rca.event",[this.name,this.origin,e]),this.lastEvent=e))}},created(){this.dragging=!1,this.readyMouseUpdate=!0,this.lastEvent=null,this.pendingMouseUpdatePromise=a,this.pendingMouseUpdateCount=0,this.onMouseMove=e=>{e.preventDefault(),this.sendEvent(this.toEvent("mouse-move",e))},this.onMouseUp=e=>{e.preventDefault(),this.dragging=!1,this.sendEvent(this.toEvent("mouse-up",e)),document.removeEventListener("mousemove",this.onMouseMove),document.removeEventListener("mouseup",this.onMouseUp)},this.finallyEventUpdate=()=>{this.readyMouseUpdate=!0,this.pendingEventUpdateCount&&(this.pendingEventUpdateCount=0,this.sendEvent(this.lastEvent))},this.currentSizeUpdateEvent={w:10,h:10,p:window.devicePixelRatio},this.readySizeUpdate=!0,this.pendingSizeUpdatePromise=a,this.pendingSizeUpdateCount=0,this.finallySizeUpdate=()=>{this.readySizeUpdate=!0,this.pendingSizeUpdateCount&&(this.pendingSizeUpdateCount=0,this.pushSize())},this.observer=new ResizeObserver(()=>{if(!this.$el)return;const e=this.$el.getBoundingClientRect(),{top:t,left:n}=e;this.currentSizeUpdateEvent.w=e.width,this.currentSizeUpdateEvent.h=e.height,this.currentSizeUpdateEvent.p=window.devicePixelRatio,this.currentOffset=[n,t],this.pushSize()})},mounted(){this.observer.observe(this.$el)},beforeUnmount(){this.observer.unobserve(this.$el)},inject:["trame"],provide(){return{rcaPushSize:e=>this.pushSize(e)}}},c=u,f=n("efcf");function d(e,t,n,r,o,i,s,a){var u,c="function"===typeof e?e.options:e;if(t&&(c.render=t,c.staticRenderFns=n,c._compiled=!0),r&&(c.functional=!0),i&&(c._scopeId="data-v-"+i),s?(u=function(e){e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,e||"undefined"===typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),o&&o.call(this,e),e&&e._registeredComponents&&e._registeredComponents.add(s)},c._ssrRegister=u):o&&(u=a?function(){o.call(this,(c.functional?this.parent:this).$root.$options.shadowRoot)}:o),u)if(c.functional){c._injectStyles=u;var f=c.render;c.render=function(e,t){return u.call(t),f(e,t)}}else{var d=c.beforeCreate;c.beforeCreate=d?[].concat(d,u):[u]}return{exports:e,options:c}}function l(e){this["$style"]=f["default"].locals||f["default"]}var p=d(c,i,s,!1,l,null,null),h=p.exports,v=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticStyle:{width:"100%",height:"100%"}},[n("image-display-area",{attrs:{name:e.name,origin:e.origin,poolSize:4}}),n("video-display-area",{attrs:{name:e.name,origin:e.origin}})],1)},m=[],b=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("img",{directives:[{name:"show",rawName:"v-show",value:e.hasContent,expression:"hasContent"}],attrs:{src:e.displayURL}})},y=[];n("14d9");class g{constructor(e){this.vueComponent=e,this.img=new Image,this.url="",this.blob=null,this.img.addEventListener("load",()=>{this.vueComponent.displayURL=this.url,this.vueComponent.hasContent=!0})}update(e,t){window.URL.revokeObjectURL(this.url),this.blob=new Blob([t],{type:e}),this.url=URL.createObjectURL(this.blob),this.img.src=this.url}}var S={name:"ImageDisplayArea",props:{name:{type:String,default:"default"},origin:{type:String,default:"anonymous"},poolSize:{type:Number,default:4}},watch:{poolSize(){this.updatePoolSize()}},data(){return{hasContent:!1,displayURL:""}},methods:{resetContent(){this.hasContent=!1},updatePoolSize(){while(this.frames.length<this.poolSize)this.frames.push(new g(this));while(this.frames.length>this.poolSize)this.frames.pop()}},created(){this.frames=[],this.nextFrameIndex=0,this.updatePoolSize(),this.wslinkSubscription=null,this.onImage=([{name:e,meta:t,content:n}])=>{if(this.name===e)if("image/jpeg"===t.type){this.nextFrameIndex=(this.nextFrameIndex+1)%this.frames.length;const e=this.frames[this.nextFrameIndex];e.update(t.type,n)}else this.hasContent=!1},this.trame&&(this.wslinkSubscription=this.trame.client.getConnection().getSession().subscribe("trame.rca.topic.stream",this.onImage))},beforeUnmount(){this.wslinkSubscription&&this.trame&&(this.trame.client.getConnection().getSession().unsubscribe(this.wslinkSubscription),this.wslinkSubscription=null)},inject:["trame"]},x=S,w=d(x,b,y,!1,null,null,null),E=w.exports,O=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("video",{directives:[{name:"show",rawName:"v-show",value:e.hasContent,expression:"hasContent"}],attrs:{autoplay:"autoplay",muted:"muted"},domProps:{muted:!0}},[e._v(" Your browser does not support the video tag. ")])},j=[];class C{constructor(e,t="video/webm; codecs=vp09.00.10.08"){this.videoElement=e,this.mime=t,this.sourceBuffer=null,this.mediaSource=null,this.queue=[],this.loaded=0,this.queue.push=e=>{"open"===this.mediaSource.readyState&&this.sourceBuffer&&!1===this.sourceBuffer.updating?(this.sourceBuffer.appendBuffer(e),this.loaded+=1):Array.prototype.push.call(this,e)},"MediaSource"in window?(this.mediaSource=new MediaSource,this.videoElement.src=URL.createObjectURL(this.mediaSource),this.mediaSource.addEventListener("sourceopen",()=>{URL.revokeObjectURL(this.videoElement.src),console.log("media-source readyState="+this.mediaSource.readyState),this.initBuffer()})):console.error("The Media Source Extensions API is not supported.")}initBuffer(){MediaSource.isTypeSupported(this.mime)?(console.log("addSourceBuffer: "+this.mime),this.sourceBuffer=this.mediaSource.addSourceBuffer(this.mime),this.sourceBuffer.mode="sequence"):console.error("Unsupported MIME type or codec: "+this.mime)}reset(){this.videoElement.src&&URL.revokeObjectURL(this.videoElement.src),this.sourceBuffer=null,this.mediaSource=null,this.queue.length=0}queueChunk(e){console.log("q-add length="+this.queue.length),this.queue.push(e)}exit(){URL.revokeObjectURL(this.videoElement.src)}}var U={name:"VideoDisplayArea",props:{name:{type:String,default:"default"},origin:{type:String,default:"anonymous"}},data(){return{hasContent:!1,loaded:0,received:0}},methods:{requestKeyframeHeader(){console.log("requestKeyframeHeader"),this.rcaPushSize&&(console.log("push size with video header"),this.rcaPushSize({videoHeader:1}))}},created(){console.log("created video vue component"),this.pushChunk=(e,t)=>{console.log(`pushChunk l=${this.loaded} r=${this.received} d=${this.received-this.loaded}`),this.decoder.mime!==t&&(this.decoder.reset(),this.decoder=new C(this.$el,t),this.requestKeyframeHeader()),this.decoder.queueChunk(e),this.loaded=this.decoder.loaded,this.hasContent=!0}},mounted(){console.log("mounted video vue component"),this.decoder=new C(this.$el),this.onChunkAvailable=([{name:e,meta:t,content:n}])=>{this.name===e&&t.type.includes("video/")&&(this.received+=1,console.log("onChunkAvailable type="+t.type),n.arrayBuffer().then(e=>this.pushChunk(e,t.type)))},this.trame&&(this.wslinkSubscription=this.trame.client.getConnection().getSession().subscribe("trame.rca.topic.stream",this.onChunkAvailable),this.requestKeyframeHeader())},beforeUnmount(){this.wslinkSubscription&&this.trame&&(this.trame.client.getConnection().getSession().unsubscribe(this.wslinkSubscription),this.wslinkSubscription=null,this.decoder.exit())},inject:["trame","rcaPushSize"]},P=U,_=d(P,O,j,!1,null,null,null),z=_.exports,M={name:"DisplayArea",components:{ImageDisplayArea:E,VideoDisplayArea:z},props:{name:{type:String,default:"default"},origin:{type:String,default:"anonymous"}}},L=M,R=d(L,v,m,!1,null,null,null),k=R.exports,A={RemoteControlledArea:h,DisplayArea:k,ImageDisplayArea:E,VideoDisplayArea:z};function D(e){Object.keys(A).forEach(t=>{e.component(t,A[t])})}},fc6a:function(e,t,n){var r=n("44ad"),o=n("1d80");e.exports=function(e){return r(o(e))}},fdbf:function(e,t,n){var r=n("04f8");e.exports=r&&!Symbol.sham&&"symbol"==typeof Symbol.iterator}})}));
//# sourceMappingURL=vue-trame_rca.umd.min.js.map